<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Event Time</title>

	<link rel="stylesheet" href="../css/main.css" />
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
		integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
</head>

<body id="admin-zone">
	<div class="module" data-module="partials/navbar.html"></div>

	<main class="main">
		<div class="module" data-module="partials/top_nav.html"></div>

		<div class="container">
			<div class="page-title">Users</div>
			<button class="button button-success"><i class="fas fa-plus"></i> Create new</button>
			<div class="adm-tabel">
				<table class="space-top">
					<thead>
						<tr>
							<th>Name</th>
							<th>Email</th>
							<th>Password</th>
							<th>Action</th>
						</tr>
					</thead>
					<tbody>
						<!-- <tr>
							<td>Jill</td>
							<td>Smith</td>
							<td>jill@gmail.com</td>
							<td>50</td>
							<td>
								<button class="button button-icon"><i class="fas fa-info"></i></button>
								<button class="button button-icon hover-info"><i class="fas fa-pen"></i></button>
								<button class="button button-icon hover-danger"><i class="fas fa-trash"></i></button>
							</td>
						</tr>
						<tr>
							<td>Jill</td>
							<td>Smith</td>
							<td>jill@gmail.com</td>
							<td>50</td>
							<td>
								<button class="button button-icon"><i class="fas fa-info"></i></button>
								<button class="button button-icon hover-info"><i class="fas fa-pen"></i></button>
								<button class="button button-icon hover-danger"><i class="fas fa-trash"></i></button>
							</td>
						</tr>
						<tr>
							<td>Jill</td>
							<td>Smith</td>
							<td>jill@gmail.com</td>
							<td>50</td>
							<td>
								<button class="button button-icon"><i class="fas fa-info"></i></button>
								<button class="button button-icon hover-info"><i class="fas fa-pen"></i></button>
								<button class="button button-icon hover-danger"><i class="fas fa-trash"></i></button>
							</td>
						</tr>
						<tr>
							<td>Jill</td>
							<td>Smith</td>
							<td>jill@gmail.com</td>
							<td>50</td>
							<td>
								<button class="button button-icon"><i class="fas fa-info"></i></button>
								<button class="button button-icon hover-info"><i class="fas fa-pen"></i></button>
								<button class="button button-icon hover-danger"><i class="fas fa-trash"></i></button>
							</td>
						</tr>
						<tr>
							<td>Jill</td>
							<td>Smith</td>
							<td>jill@gmail.com</td>
							<td>50</td>
							<td>
								<button class="button button-icon"><i class="fas fa-info"></i></button>
								<button class="button button-icon hover-info"><i class="fas fa-pen"></i></button>
								<button class="button button-icon hover-danger"><i class="fas fa-trash"></i></button>
							</td>
						</tr> -->
					</tbody>

					<script>
						let tbody = document.querySelector("tbody");

						fetch("http://localhost:3000/users", {
								method: "GET",
								headers: {
									'Content-Type': 'application/json'
								}
							})
							.then(function (response) {
								return response.json();
							})
							.then(function (myJson) {
								var users = myJson.data;
								users.forEach(element => {
									let tr = document.createElement("tr");
									let tdName = document.createElement("td");
									let tdEmail = document.createElement("td");
									let tdPassword = document.createElement("td");
									let tdButtons = document.createElement("td");

									let btn1 = document.createElement('button');
									btn1.className += "button";
									btn1.className += " button-icon";
									btn1.addEventListener('click', () => {
										console.log("Nothing here!");
									});
									let i1 = document.createElement("i");
									i1.className += "fas";
									i1.className += " fa-info";
									btn1.appendChild(i1);
									let btn2 = document.createElement('button');
									btn2.className += "button";
									btn2.className += " button-icon";
									btn2.className += " hover-info";
									let i2 = document.createElement("i");
									i2.className += "fas";
									i2.className += " fa-pen";
									btn2.appendChild(i2);
									let btn3 = document.createElement('button');
									btn3.className += "button";
									btn3.className += " button-icon";
									btn3.className += " hover-danger";
									btn3.addEventListener('click', () => {
										fetch('http://localhost:3000/users?id=' + element._id, {
												method: "DELETE",
												headers: {
													'Content-Type': 'application/json'
												}
											})
											.then(resp => resp.json())
											.then(myJson2 => {
												console.log(myJson2);
											})
											.catch(err => {
												alert("some error occured");
											});
									});
									let i3 = document.createElement("i");
									i3.className += "fas";
									i3.className += " fa-trash";
									btn3.appendChild(i3);

									tdName.innerText = element.name;
									tdEmail.innerText = element.email;
									tdPassword.innerText = element.password;

									tdButtons.appendChild(btn1);
									tdButtons.appendChild(btn2);
									tdButtons.appendChild(btn3);
									tr.appendChild(tdName);
									tr.appendChild(tdEmail);
									tr.appendChild(tdPassword);
									tr.appendChild(tdButtons);
									tbody.appendChild(tr);
								});
							})
							.catch(err => {
								console.log(err);
							});
					</script>
				</table>
			</div>
		</div>
	</main>
	<script src="../scripts/modules.js"></script>
	<script src="../scripts/left-side-navbar.js"></script>
</body>

</html>